<!doctype html>
<html lang="en" dir="ltr" data-bs-theme="dark">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="theme-color" content="#3a334a">
		<title>{{ user.username }} - Sub Info</title>
		<link href="https://raw.githubusercontent.com/hirzuko/marz-gd-template/refs/heads/main/img/apple-touch-logo" rel="apple-touch-icon" sizes="180x180">
		<link href="https://raw.githubusercontent.com/hirzuko/marz-gd-template/refs/heads/main/img/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
		<link href="https://raw.githubusercontent.com/hirzuko/marz-gd-template/refs/heads/main/img/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
		<link rel="stylesheet" id="dynamic-stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" crossorigin="anonymous" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
		<link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap" rel="stylesheet">
		<script>
			var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="";var n,r,i,s,o,u,a;var f=0;e=Base64._utf8_encode(e);while(f<e.length){n=e.charCodeAt(f++);r=e.charCodeAt(f++);i=e.charCodeAt(f++);s=n>>2;o=(n&3)<<4|r>>4;u=(r&15)<<2|i>>6;a=i&63;if(isNaN(r)){u=a=64}else if(isNaN(i)){a=64}t=t+this._keyStr.charAt(s)+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)}return t},decode:function(e){var t="";var n,r,i;var s,o,u,a;var f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length){s=this._keyStr.indexOf(e.charAt(f++));o=this._keyStr.indexOf(e.charAt(f++));u=this._keyStr.indexOf(e.charAt(f++));a=this._keyStr.indexOf(e.charAt(f++));n=s<<2|o>>4;r=(o&15)<<4|u>>2;i=(u&3)<<6|a;t=t+String.fromCharCode(n);if(u!=64){t=t+String.fromCharCode(r)}if(a!=64){t=t+String.fromCharCode(i)}}t=Base64._utf8_decode(t);return t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},_utf8_decode:function(e){var t="";var n=0;var r=c1=c2=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){c2=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|c2&63);n+=2}else{c2=e.charCodeAt(n+1);c3=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63);n+=3}}return t}}
			const linkFull = "{{ user.subscription_url }}";
			var qrLink = linkFull;
			const link64 = Base64.encode(linkFull);
			const subname = "{{ user.username }}";
		</script>
		<style>
			body {
				background-image: url('https://raw.githubusercontent.com/hirzuko/marz-gd-template/refs/heads/main/img/background.png');
				background-size: cover;
				background-position: center;
				background-attachment: fixed;
				background-repeat: no-repeat;
			}
			.my-block {
				padding: 1rem;
				padding-top: 0.5rem;
				padding-bottom: 1.25rem;
				border-radius: var(--bs-border-radius-xl);
				background-color: var(--bs-secondary-bg);
				border: 1px solid rgba(255, 255, 255, 0.25);
            	backdrop-filter: blur(8px);
            	-webkit-backdrop-filter: blur(8px);
			}
			
			.my-btn {
				--bs-btn-bg: rgba(var(--bs-my-btn-bg-rgb), .15);
				--bs-btn-color: var(--bs-my-btn-bg);
				--bs-btn-hover-bg: rgba(var(--bs-my-btn-bg-rgb), .2);
				--bs-btn-hover-color: var(--bs-my-btn-bg);
				--bs-btn-active-bg: rgba(var(--bs-my-btn-bg-rgb), .25);
				--bs-btn-active-color: var(--bs-my-btn-bg);
				--bs-btn-focus-shadow-rgb: var(--bs-my-btn-bg-rgb);
				
				--bs-btn-hover-border-color: transparent;
				--bs-btn-active-border-color: transparent;
				--bs-btn-border-radius: var(--bs-border-radius-xl);
				--bs-btn-font-weight: 600;
			}
			
			.my-btn-accent {
				--bs-btn-bg: rgba(var(--bs-my-btn-accent-bg-rgb), 0.85);
				--bs-btn-color: #fff;
				--bs-btn-hover-bg: rgba(var(--bs-my-btn-accent-bg-rgb), 1.0);
				--bs-btn-hover-color: #fff;
				--bs-btn-active-bg: rgba(var(--bs-my-btn-accent-bg-rgb), 1.0);
				--bs-btn-active-color: #fff;
				--bs-btn-focus-shadow-rgb: var(--bs-my-btn-accent-bg-rgb);
			}
			
			.my-color-green,
			.my-color-red,
			.my-color-blue,
			.my-color-yellow {
				color: #9370DB;
			}
			
			.my-container {
				max-width: 64rem;
			}
			
			.my-dropdown-menu {
				--bs-dropdown-border-radius: var(--bs-border-radius-xl);
				--bs-dropdown-item-padding-x: .75rem;
				--bs-dropdown-item-padding-y: .5rem;
				--bs-dropdown-padding-x: .35rem;
				--bs-dropdown-padding-y: .35rem;
				--bs-dropdown-link-hover-bg: var(--bs-secondary-bg);
				--bs-dropdown-link-active-bg: var(--bs-secondary-bg);
				--bs-dropdown-link-active-color: #fff;
				
				background-color: rgba(255, 255, 255, 0.01);
				border: 1px solid rgba(255, 255, 255, 0.25);
				backdrop-filter: blur(8px);
				-webkit-backdrop-filter: blur(8px);

				.my-dropdown-item-icon, .active .my-dropdown-item-check {
					color: rgba(255, 255, 255, .5);
				}
			
				li + li {
					margin-top: .35rem;
				}
				
				.dropdown-item {
					border-radius: .75rem;
				}
				
				.my-dropdown-item-check {
					color: transparent;
				}
			}
			
			.my-icon {
				width: 32px;
				height: 32px;
				fill: currentcolor;
			}

			.my-icon-small {
				width: 24px;
				height: 24px;
				fill: currentcolor;
			}
			
			.my-link-separate {
				font-family: "Apple Color Emoji", "Noto Color Emoji", "Segoe UI Emoji", "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", "Noto Sans", "Liberation Sans", Arial, sans-serif, "Segoe UI Symbol";
				background-color: transparent;
			}
			
			.my-link-separate:focus {
				outline: none !important;
			}
			
			.my-nav-link {
				--bs-nav-link-color: rgba(var(--bs-emphasis-color-rgb), .65);
				--bs-nav-link-hover-color: rgba(var(--bs-emphasis-color-rgb), .9);
			}
			
			.my-warning {
				color: #f8f9fa;
				background-color: rgba(255, 193, 7, 0.2);
				padding: 1.5rem;
				padding-top: 1.0rem;
				padding-bottom: 0.5rem;
				border-radius: var(--bs-border-radius-xl);
				border: 1px solid rgba(255, 193, 7, 0.5);
			}
		
			.accordion {
				--bs-accordion-btn-focus-box-shadow: transparent;
				--bs-accordion-active-bg: tranparent;
				--bs-accordion-active-color: #fff;
			}
			
			.accordion-item {
				--bs-accordion-border-width: 0px;
				background-color: var(--bs-secondary-bg);
				border: 1px solid rgba(255, 255, 255, 0.25);
				backdrop-filter: blur(8px);
				-webkit-backdrop-filter: blur(8px);
			}
			
			.accordion-button {
				padding: var(--bs-accordion-btn-padding-y) 0rem;
				background-color: transparent;
			}
			
			.accordion-button:hover {
				text-decoration: underline !important;
			}
			
			.bi {
				width: 1em;
				height: 1em;
				vertical-align: -.125em;
				fill: currentcolor;
			}
			
			.form-control:disabled {
				background-color: transparent;
			}
			
			[data-bs-theme='dark'] {
				--bs-body-bg: #3a334a;
				--bs-secondary-bg: rgba(58, 51, 74, 0.01);
				--bs-secondary-rgb: 58, 51, 74;
				--bs-my-btn-bg: #9370DB;
				--bs-my-btn-bg-rgb: 147, 112, 219;
				--bs-my-btn-accent-bg-rgb: 147, 112, 219;
			}
		</style>
	<link rel="stylesheet" href="/index.css">
</head>
	<body>
	
		<!-- Apps icons -->
		<svg xmlns="http://www.w3.org/2000/svg" class="d-none">
			<symbol id="qr" viewBox="0 0 16 16">
				<path fill-rule="evenodd" clip-rule="evenodd" d="M2 0C0.895431 0 0 0.89543 0 2V5.5C0 6.60457 0.89543 7.5 2 7.5H5.5C6.60457 7.5 7.5 6.60457 7.5 5.5V2C7.5 0.895431 6.60457 0 5.5 0H2ZM2.5 1.5C1.94772 1.5 1.5 1.94772 1.5 2.5V5C1.5 5.55228 1.94772 6 2.5 6H5C5.55228 6 6 5.55228 6 5V2.5C6 1.94772 5.55228 1.5 5 1.5H2.5Z"/>
				<path d="M2.25 2.75C2.25 2.47386 2.47386 2.25 2.75 2.25H4.75C5.02614 2.25 5.25 2.47386 5.25 2.75V4.75C5.25 5.02614 5.02614 5.25 4.75 5.25H2.75C2.47386 5.25 2.25 5.02614 2.25 4.75V2.75Z"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 0C9.39543 0 8.5 0.89543 8.5 2V5.5C8.5 6.60457 9.39543 7.5 10.5 7.5H14C15.1046 7.5 16 6.60457 16 5.5V2C16 0.895431 15.1046 0 14 0H10.5ZM11 1.5C10.4477 1.5 10 1.94772 10 2.5V5C10 5.55228 10.4477 6 11 6H13.5C14.0523 6 14.5 5.55228 14.5 5V2.5C14.5 1.94772 14.0523 1.5 13.5 1.5H11Z"/>
				<path d="M10.75 2.75C10.75 2.47386 10.9739 2.25 11.25 2.25H13.25C13.5261 2.25 13.75 2.47386 13.75 2.75V4.75C13.75 5.02614 13.5261 5.25 13.25 5.25H11.25C10.9739 5.25 10.75 5.02614 10.75 4.75V2.75Z"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M2 8.5C0.895431 8.5 0 9.39543 0 10.5V14C0 15.1046 0.89543 16 2 16H5.5C6.60457 16 7.5 15.1046 7.5 14V10.5C7.5 9.39543 6.60457 8.5 5.5 8.5H2ZM2.5 10C1.94772 10 1.5 10.4477 1.5 11V13.5C1.5 14.0523 1.94772 14.5 2.5 14.5H5C5.55228 14.5 6 14.0523 6 13.5V11C6 10.4477 5.55228 10 5 10H2.5Z"/>
				<path d="M2.25 11.25C2.25 10.9739 2.47386 10.75 2.75 10.75H4.75C5.02614 10.75 5.25 10.9739 5.25 11.25V13.25C5.25 13.5261 5.02614 13.75 4.75 13.75H2.75C2.47386 13.75 2.25 13.5261 2.25 13.25V11.25Z"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M10.5 8.5C9.39543 8.5 8.5 9.39543 8.5 10.5V14C8.5 15.1046 9.39543 16 10.5 16H14C15.1046 16 16 15.1046 16 14V10.5C16 9.39543 15.1046 8.5 14 8.5H10.5ZM11 10C10.4477 10 10 10.4477 10 11V13.5C10 14.0523 10.4477 14.5 11 14.5H13.5C14.0523 14.5 14.5 14.0523 14.5 13.5V11C14.5 10.4477 14.0523 10 13.5 10H11Z"/>
			</symbol>
		</svg>
		<div class="container my-container py-3 pb-5">
			
			<!-- Copied to clipboard notification -->
			<div class="toast-container position-fixed bottom-0 start-50 translate-middle-x p-3">
				<div class="toast text-bg-primary border border-0 rounded-4" id="toast-copy-link" role="alert" aria-atomic="true" aria-live="assertive">
					<div class="d-flex justify-content-between align-items-center">
						<span class="toast-body fs-6 fw-semibold">Copied to clipboard</span>
						<button type="button" class="btn-close m-3" data-bs-dismiss="toast" aria-label="Close"></button>
					</div>
				</div>
			</div>
			
			<!-- QR Modal -->
			<div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel">
				<div class="modal-sm modal-dialog modal-dialog-centered">
					<div class="text-bg-secondary modal-content border border-0 rounded-4 shadow-lg">
						<div class="d-flex modal-header justify-content-between">
							<h1 class="modal-title my-link-separate fw-bold fs-5" id="qrModalLabel"></h1>
							<button type="button" class="btn-close m-0" data-bs-dismiss="modal" aria-label="Close"></button>
						</div>
						<div class="modal-body d-flex justify-content-center align-items-center">
							<div id="qrcode"></div>
						</div>
					</div>
				</div>
			</div>
			
			<!-- Logo, support and language switcher -->
			<header class="d-flex flex-wrap align-items-center gap-2 mb-5 justify-content-between">
				<img src="https://raw.githubusercontent.com/hirzuko/marz-gd-template/refs/heads/main/img/logo.png" alt="Logo" width="32" height="32">
			</header>
			
			<!-- Subscription username and buttons -->
			<div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
				<span class="text-break fs-3 fw-bold"><span>Subscription for</span> {{ user.username }}</span>
				<div>
					<button class="btn my-btn btn-copy-sub-link" type="button">Copy subscription link</button>
					<button class="btn my-btn btn-show-qr-sub" id="btn-show-qr-sub" data-bs-toggle="modal" data-bs-target="#qrModal" data-ignore="true">
						<svg class="bi"><use href="#qr"></use></svg>
					</button>
				</div>
			</div>
			
			<!-- Subscription status -->
			<div class="row row-cols-2 row-cols-sm-4 g-3 mb-4">
				<div class="col">
					<div class="my-block d-flex flex-column h-100">
						{% if user.status.value == 'active' %}
						<i class="bi my-color-green fs-4 mb-3 bi-emoji-smile-fill"></i>
						{% else %}
						<i class="bi my-color-red fs-4 mb-3 bi-emoji-frown-fill"></i>
						{% endif %}
						<span class="fs-5 fw-bold">Status</span>
						{% if user.status.value == 'active' %}
						<span class="fw-semibold">Active</span>
						{% elif user.status.value == 'limited' %}
						<span class="fw-semibold">Limited</span>
						{% elif user.status.value == 'expired' %}
						<span class="fw-semibold">Expired</span>
						{% elif user.status.value == 'disabled' %}
						<span class="fw-semibold">Disabled</span>
						{% endif %}
					</div>
				</div>
				<div class="col">
					<div class="my-block d-flex flex-column h-100">
						<i class="bi my-color-red fs-4 mb-3 bi-calendar3"></i>
						<span class="fs-5 fw-bold">Duration</span>
						{% if not user.expire %}
						<span class="fw-semibold">Forever</span>
						{% else %}
						<!-- Can it be done better? -->
						{% set date = (user.expire | datetime).split()[0].split('-')[::-1] %}
						<span class="fw-semibold">
							<span>Until</span>
							{{ '.'.join(date) }}
						</span>
						{% endif %}
					</div>
				</div>
				<div class="col">
					<div class="my-block d-flex flex-column h-100">
						<i class="bi my-color-blue fs-4 mb-3 bi-arrow-down-up"></i>
						<span class="fs-5 fw-bold">Traffic</span>
						<span class="fw-semibold">
							{{ user.used_traffic | bytesformat }}
							<span>of</span>
							{% if not user.data_limit %}âˆž{% else %}
							{{ user.data_limit | bytesformat }}
							{% endif %}
						</span>
					</div>
				</div>
				<div class="col">
					<div class="my-block d-flex flex-column h-100">
						<i class="bi my-color-yellow fs-4 mb-3 bi-repeat"></i>
						<span class="fs-5 fw-bold">Traffic Reset</span>
						{% if user.data_limit_reset_strategy == 'no_reset' %}
						<span class="fw-semibold">No</span>
						{% elif user.data_limit_reset_strategy == 'day' %}
						<span class="fw-semibold">Daily</span>
						{% elif user.data_limit_reset_strategy == 'week' %}
						<span class="fw-semibold">Weekly</span>
						{% elif user.data_limit_reset_strategy == 'month' %}
						<span class="fw-semibold">Monthly</span>
						{% elif user.data_limit_reset_strategy == 'year' %}
						<span class="fw-semibold">Yearly</span>
						{% endif %}
					</div>
				</div>
			</div>
			
			<!-- Separate servers links start -->
			{% if user.status == 'active' %}
			<div class="fs-3 fw-bold mb-3">List of Available Servers</div>
			<div class="my-block p-4">
				<p>In this section, you can access your configurations individually, allowing you to share each one via QR code or simply copy them</p>
				<p>This can be useful if, for example, you need to set up a connection to a specific server on a particular device</p>
				{% for link in user.links %}
				<div class="input-group input-group-lg border border-0 text-bg-dark rounded-4 mb-3">	
					<input class="form-control my-link-separate border border-0 ps-4" type="text" value="{{ link }}" disabled readonly>
					<button class="btn my-btn btn-copy-link fs-5 mt-2 mb-2 rounded-3 pb-2 pt-1" data-link="{{ link }}">
						<i class="bi bi-clipboard2-fill"></i>
					</button>
					<button class="btn my-btn btn-show-qr m-2 rounded-3" id="btn-show-qr" data-bs-toggle="modal" data-bs-target="#qrModal" data-ignore="true" data-link="{{ link }}">
						<svg class="bi"><use href="#qr"></use></svg>
					</button>
				</div>
				{% endfor %}
			</div>
			{% endif %}
			<!-- Separate servers links end -->
			
			<a href="https://t.me/Jungaballs"><button type="button" class="btn my-btn mt-4 w-100">Contact Support</button></a>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"></script>
		<script src="https://cdn.jsdelivr.net/gh/davidshimjs/qrcodejs/qrcode.min.js"></script>
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				const toastCopyLink = document.getElementById('toast-copy-link');
				
				// Copy subscription link and show toast
				document.querySelectorAll('.btn-copy-sub-link').forEach(button => {
					button.addEventListener('click', () => {
						navigator.clipboard.writeText(linkFull);
						bootstrap.Toast.getOrCreateInstance(toastCopyLink).show();
					});
				});
				
				// QR code settings
				const qrCode = new QRCode(document.getElementById("qrcode"), {
					text: qrLink,
					width: 256	,
					height: 256,
					colorDark: "#fff",
					colorLight: "#3a334a",
					correctLevel: QRCode.CorrectLevel.H
				});
				
				// Define QR modal header string container and subscription show button
				const qrModalLabel = document.getElementById('qrModalLabel');
				const qrButtonSub = document.getElementById('btn-show-qr-sub');
				
				// Change QR modal header to subscription localization string and show sub link QR
				qrButtonSub.addEventListener('click', () => {
					qrLink = linkFull;
					qrCode.clear();
					qrCode.makeCode(qrLink);
					const subscriptionTitle = 'Subscription';
					qrModalLabel.textContent = subscriptionTitle;
				});
				
				// --- Separate servers links block start ---
				const copyButtons = document.querySelectorAll('.btn-copy-link');
				const qrButtons = document.querySelectorAll('.btn-show-qr');
				const inputs = document.querySelectorAll('.my-link-separate');
			
				// Decode server name from link
				function extractName(url) {
					const decoded = decodeURIComponent(url);
				
					if (decoded.startsWith("vmess://")) {
						const encodedString = decoded.replace("vmess://", "");
						const decodedString = atob(encodedString);
						return JSON.parse(decodedString).ps;
					}
				
					const match = decoded.match(/#(.+)$/);
					return match ? match[1] : null;
				}
			
				// Show decoded server name
				inputs.forEach((input) => {
					const originalValue = input.value; 
					const name = extractName(originalValue);
					if (name) {
						input.setAttribute('data-original', originalValue);
						input.setAttribute('value', name);
					}
				});
			
				// Copy each node connection link
				copyButtons.forEach((button) => {
					button.addEventListener('click', () => {
						const separateLink = button.dataset.link;
						navigator.clipboard.writeText(separateLink);
					});
				});
				
				// Show notification toast when separate link is copied
				document.querySelectorAll('.btn-copy-link').forEach(button => {
					button.addEventListener('click', () => {
						bootstrap.Toast.getOrCreateInstance(toastCopyLink).show();
					});
				});
			
				// Generate different QR code for each separate connection link
				qrButtons.forEach((qrButton) => {
					qrButton.addEventListener('click', () => {
						const separateLink = qrButton.dataset.link;
						const name = extractName(separateLink);
						qrLink = separateLink;
						qrCode.clear();
						qrCode.makeCode(qrLink);
						
						// Change QR modal header to server name
						if (qrModalLabel) {
							qrModalLabel.textContent = GUser;
						}
					});
				});
				// --- Separate servers links block end ---
			});
		</script>
	</body
</html><script type="module" src="/index.tsx"></script>
